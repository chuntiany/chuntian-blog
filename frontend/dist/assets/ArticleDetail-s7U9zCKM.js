import{_ as w,u as C,r as u,o as D,c as o,a as t,t as l,b as p,d as x,w as S,v as b,e as A,f as F,g as L,F as N,h as V,i as m,j as B,k as s,l as h}from"./index-Du8VEhpS.js";const I={key:0,class:"article-detail"},M={class:"meta"},T={key:0},$={class:"content"},j={class:"comments-section"},E={key:0,class:"comment-form"},O={key:1},P={class:"comments-list"},R={key:0},U={key:1},W={key:2},q={__name:"ArticleDetail",setup(z){const v=B(),_=C(),a=u(null),d=u(!0),r=u(""),c=u([]),f=async()=>{try{const e=await m.get(`/api/articles/${v.params.id}`);a.value=e.data}catch(e){console.error("Failed to fetch article",e)}},y=async()=>{try{const e=await m.get(`/api/comments?article_id=${v.params.id}`);c.value=e.data}catch(e){console.error("Failed to fetch comments",e)}},g=async()=>{if(r.value.trim())try{const e=await m.post("/api/comments",{content:r.value,article_id:a.value.id});e.data.status==="approved"?c.value.unshift({id:e.data.id,content:r.value,author:_.user.username,created_at:new Date().toISOString()}):alert("Comment submitted for approval"),r.value=""}catch(e){console.error("Failed to submit comment",e),alert("Failed to submit comment")}};return D(async()=>{await f(),await y(),d.value=!1}),(e,n)=>{const k=L("router-link");return!d.value&&a.value?(s(),o("div",I,[t("h1",null,l(a.value.title),1),t("div",M,[t("span",null,"By "+l(a.value.author),1),t("span",null," | "+l(new Date(a.value.created_at).toLocaleDateString()),1),a.value.category?(s(),o("span",T," | "+l(a.value.category),1)):p("",!0)]),t("div",$,l(a.value.content),1),t("div",j,[n[3]||(n[3]=t("h3",null,"Comments",-1)),x(_).isAuthenticated?(s(),o("div",E,[S(t("textarea",{"onUpdate:modelValue":n[0]||(n[0]=i=>r.value=i),placeholder:"Write a comment...",rows:"3"},null,512),[[b,r.value]]),t("button",{onClick:g},"Post Comment")])):(s(),o("div",O,[A(k,{to:"/login"},{default:F(()=>[...n[1]||(n[1]=[h("Login to comment",-1)])]),_:1})])),t("div",P,[(s(!0),o(N,null,V(c.value,i=>(s(),o("div",{key:i.id,class:"comment"},[t("p",null,[t("strong",null,l(i.author),1),n[2]||(n[2]=h(" said:",-1))]),t("p",null,l(i.content),1),t("small",null,l(new Date(i.created_at).toLocaleDateString()),1)]))),128)),c.value.length===0?(s(),o("div",R,"No comments yet.")):p("",!0)])])])):d.value?(s(),o("div",W,"Loading...")):(s(),o("div",U,"Article not found"))}}},H=w(q,[["__scopeId","data-v-df0a5a6e"]]);export{H as default};
